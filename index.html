<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product App</title>
<style>
*{box-sizing:border-box;font-family:Arial}
body{margin:0;background:#ff9933;height:100vh;display:flex;flex-direction:column}
.top{padding:12px}
.top input{width:100%;padding:12px 16px;border:none;border-radius:25px;font-size:16px}
.list{flex:1;overflow-y:auto;padding:10px}
.card{background:#1e90ff;border-radius:14px;padding:15px;margin-bottom:12px;position:relative;display:flex;gap:10px;align-items:center}
.card input{width:45%;border:none;border-radius:10px;padding:10px}
.menu-btn{position:absolute;right:10px;top:8px;color:#fff;font-size:22px;cursor:pointer}
.menu{position:fixed;top:10px;right:10px;background:#fff;border-radius:10px;display:none;z-index:1000}
.menu div{padding:10px 15px;cursor:pointer}
.menu div:hover{background:#eee}
.bottom{display:flex;justify-content:center;padding:15px}
.plus{width:65px;height:65px;border-radius:50%;background:#1e90ff;color:#fff;font-size:36px;display:flex;align-items:center;justify-content:center}
</style>
</head>
<body>

<div class="top">
  <input id="search" placeholder="Search product">
</div>

<div class="list" id="list"></div>

<div class="bottom">
  <div class="plus" id="add">+</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getDatabase, ref, push, onValue, update, remove } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

/* ðŸ”´ Firebase Config - Tumhara Project */
const firebaseConfig = {
  apiKey: "AIzaSyDSCAyKVpBz7Ldip3ZSPI3OPSMz6CvLD3M",
  authDomain: "project-194dc.firebaseapp.com",
  databaseURL: "https://project-194dc-default-rtdb.firebaseio.com",
  projectId: "project-194dc",
  storageBucket: "project-194dc.appspot.com",
  messagingSenderId: "1093664492890",
  appId: "1:1093664492890:web:9e7b6a4aa3b7b57bffb763"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const productsRef = ref(db, "products");

const list = document.getElementById("list");
const add = document.getElementById("add");
const search = document.getElementById("search");

let products = [];

/* ðŸ”¥ Load data from Firebase */
onValue(productsRef, (snapshot)=>{
  products = [];
  snapshot.forEach(child => {
    products.push({id: child.key, ...child.val(), edit:false});
  });
  render(products);
});

function render(data){
  list.innerHTML = "";
  data.forEach(p=>{
    const card = document.createElement("div");
    card.className = "card";

    const name = document.createElement("input");
    name.value = p.name;
    name.disabled = !p.edit;

    const price = document.createElement("input");
    price.value = p.price;
    price.disabled = !p.edit;

    const dots = document.createElement("div");
    dots.className = "menu-btn";
    dots.innerText = "â‹®";

    const menu = document.createElement("div");
    menu.className = "menu";
    menu.innerHTML = "<div>Edit</div><div>Save</div><div>Delete</div>";

    dots.onclick = (e)=>{
      e.stopPropagation();
      document.querySelectorAll(".menu").forEach(m=>m.style.display="none");
      menu.style.display="block";
    };

    menu.children[0].onclick = ()=>{
      p.edit = true;
      render(products);
    };

    menu.children[1].onclick = ()=>{
      update(ref(db, "products/"+p.id), {
        name: name.value,
        price: price.value
      });
      p.edit = false;
      render(products);
    };

    menu.children[2].onclick = ()=>{
      remove(ref(db, "products/"+p.id));
    };

    card.append(price, name, dots, menu);
    list.appendChild(card);
  });
}

/* ðŸ”¹ Add product */
add.onclick = ()=>{
  push(productsRef, {
    name: "Product Name",
    price: "Price"
  });
};

/* ðŸ”¹ Search filter */
search.oninput = ()=>{
  const v = search.value.toLowerCase();
  render(products.filter(p=>p.name.toLowerCase().includes(v)));
};
</script>

</body>
</html>
